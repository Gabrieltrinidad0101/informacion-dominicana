name: Deploy Changed Services

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 2

      - name: Login to registry (if needed)
        run: echo "login or docker context here"

      - name: Build & Restart only changed services
        env:
          SECRET_SERVER: $${{ secrets.SSH_SERVER_PASSWORD }}
        run: ./build-changed-services.sh
